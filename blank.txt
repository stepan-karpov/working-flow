Поскольку я потратил около 15 часов на то, чтобы сдать задачу H, то вот список ошибок, которые я получил (может быть кому-нибудь поможет)

#10H_WA9 см. выше
#10H_TL40 - здесь может быть несколько кейсов, из-за которых может не проходить TL. Вот некоторые из них:
- если вы сливаете два карасика, то лучше сливать меньший карасик в больший из-за перевыделения памяти
- если вы храните уже добавленные строки в map'е, то это плохая идея, ибо это долго
- карасика из задачи С надо улучшить, чтобы каждый раз не идти по суф ссылкам (даже сжатым), быстрее просто насчитать динамику
- vector.reserve() !!! (может быть я криво написал, но после добавления этой строчки у меня зашло две задачи)
- не знаю, насколько это помогло, но я заменил все вектора на стат массивы. Наверное не очень, но мало ли...
#10H_TL49 - как оказалось, каждый раз при слиянии двух боров строить автомат Ахо-Корасик времязатратно, поэтому лучше это делать лениво и запускать самого карася только тогда, когда нам нужно от него получить что-нибудь. Если надо просто объединить два бора, то не надо строить автомат
#10H_WA59 - переполнение, заменить int на long long
#10H_TL60 - получив WA59, я заменил ВСЕ int'ы на long long. Это была плохая идея, нужно заменить int на ll только там, где используется счетчик))

P.S. ну и, конечно же, не стоит сдавать эту задачу на двадцатых плюсах, поскольку они медленные, а TL в контесте рассчитан не пропорционально